violence <- read.csv("~/PSY 4802/Project-for-PSY-4802/20200306 Data International Women's Day Viz5 Launch.csv")
View(violence)
violence <- read.csv("~/PSY 4802/Project-for-PSY-4802/20200306 Data International Women's Day Viz5 Launch.csv")
data(violence)
levels(violence$Country)
levels(as.factor(violence$Country))
library(shiny)
ui <- fluidPage()
server <- function(input, output) {}
shinyApp(ui = ui, server = server)
ui <- fluidPage("I LOVE PSY4802!")
server <- function(input, output) {}
shinyApp(ui = ui, server = server)
sliderInput(inputId="number", label="Pick a number", value=13, min=1, max=100)
ui <- fluidPage(
sliderInput(inputId = "number",
label = "Pick a number",
value = 13, min = 0, max = 100),
plotOutput("hist")
)
server <- function(input, output) {}
shinyApp(ui = ui, server = server)
set.seed(25)
rnorm(32)
library(ggplot2)
ggplot(,aes(rnorm(32)))+ geom_histogram()
ui <- fluidPage(
sliderInput(inputId = "number",
label = "Pick a number",
value = 13, min = 0, max = 100),
plotOutput("hist")
)
server <- function(input, output) {
output$hist <- renderPlot({
ggplot(, aes(rnorm(input$number)))+ geom_histogram(fill="darksalmon")+theme_classic()
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(
sliderInput(inputId = "number",
label = "Pick a number",
value = 13, min = 0, max = 100),
plotOutput("hist")
)
server <- function(input, output) {
output$hist <- renderPlot({
ggplot(, aes(rnorm(input$number)))+ geom_histogram(fill="darksalmon")+theme_classic()
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(
sliderInput(inputId = "number",
label = "Pick a number",
value = 2500, min = 1, max = 5000))
server <- function(input, output) {}
shinyApp(ui = ui, server = server)
ui <- fluidPage(
sliderInput(inputId = "number",
label = "Pick a number",
value = 2500, min = 1, max = 5000), plotOutput("hist")
)
server <- function(input, output) {
output$hist <- renderPlot({
ggplot(, aes(rnorm(input$number)))+ geom_histogram(fill="midnightblue")+theme_classic()
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(
sliderInput(inputId = "number",
label = "Pick a number",
value = 2500, min = 1, max = 5000), plotOutput("boxp")
)
server <- function(input, output) {
output$boxp <- renderPlot({
ggplot(, aes(rnorm(input$number)))+ geom_boxplot(fill="midnightblue")+theme_classic()
})
}
shinyApp(ui = ui, server = server)
ui <- fluidPage(
sliderInput(inputId = "number1",
label = "Pick a number",
value = 2500, min = 1, max = 5000),sliderInput(inputId = "number2",
label = "Pick a number",
value = 2500, min = 1, max = 5000), plotOutput("scatterplot")
)
server <- function(input, output) {
output$scatterplot <- renderPlot({
ggplot(, aes(rnorm(input$number1), rnorm(input$number2)))+ geom_point(color="purple")+theme_classic()
})
}
shinyApp(ui = ui, server = server)
data(diamonds)
ui<- fluidPage(
titlePanel("diamonds data"),
sidebarLayout(
sidebarPanel(
selectInput(inputId= "colorChoice", label="Select Diamond Color", choices= c("D"="D", "E"="E", "F"= "F", "G"="G", "H"="H", "I"="I", "J"="J"))),
mainPanel(
plotOutput("colorgraph")
)
)
)
server <- function(input, output) {
output$colorgraph <- renderPlot({
ggplot(diamonds[diamonds$color==input$colorChoice,], aes(carat))+ geom_histogram(fill= "lightseagreen",bins= 50)+theme_classic()
})
}
shinyApp(ui = ui, server = server)
ui<- fluidPage(
titlePanel("diamonds data"),
sidebarLayout(
sidebarPanel(
selectInput(inputId= "colorChoice", label="Select Diamond Color", choices= c("D"="D", "E"="E", "F"= "F", "G"="G", "H"="H", "I"="I", "J"="J"))),
mainPanel(
plotOutput("colorgraph")
)
)
)
server <- function(input, output) {
output$colorgraph <- renderPlot({
ggplot(diamonds[diamonds$color==input$colorChoice,], aes(carat, price))+ geom_point(color= "lightseagreen")+theme_classic()+ labs(title= "carat size of diamonds")
})
}
shinyApp(ui = ui, server = server)
violence <- read.csv("~/PSY 4802/Project-for-PSY-4802/20200306 Data International Women's Day Viz5 Launch.csv")
View(violence)
levels(as.factor(violence$Country))
levels(as.factor(violence$Survey.Year))
levels(as.factor(violence$Demographics.Response))
View(violence)
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "condition", "Question", "Survey.Year"), names_from = "Demographics.Question", values_from = "Demographics.Response")
library(tidyverse)
library(tidyverse)
library(ggplot2)
View(violence)
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "condition", "Question", "Survey.Year"), names_from = "Demographics.Question", values_from = "Demographics.Response")
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "Question", "Survey.Year"), names_from = "Demographics.Question", values_from = "Demographics.Response")
View(violence_wider)
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "Question", "Survey.Year"), names_from = "Demographics.Question", values_from = "Demographics.Response", "Value")
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "Question", "Survey.Year"), names_from = "Demographics.Question", values_from = c("Demographics.Response", "Value"))
View(violence_wider)
lm(Value ~ Question, data = violence)
Question <- relevel(Question, ref = "... if she burns the food")
violence$Question <- relevel(violence$Question, ref = "... if she burns the food")
Question <- relevel(Question, ref = "... if she burns the food")
violence$Question <- relevel(as.factor(violence$Question), ref = "... if she burns the food")
lm(Value ~ Question, data = violence)
lm(Value ~ Question * Country, data = violence)
ggplot(violence, aes(Value, Question)) + geom_point() + geom_smooth(method="lm") + facet_wrap(~Country)
ggplot(violence, aes(Value, Question, color = Country)) + geom_point() + geom_smooth(method="lm") + facet_wrap(~Country)
set.seed(137)
state_university <- sample(c("UMN", "UMD", "UMICH", "KU", "UGA", "NYU", "Rutgers", "URI", "UPENN", "OHIO", "PENNSTATE", "UDEL", "UCONN", "UCLA", "UCRIVERSIDE", "UCSANTABARBARA", "UCMERCED", "NDSU", "USC", "UNC"), 100, replace = TRUE)
radius <- abs(rnorm(n = 100, mean = 1, sd = .25)) #miles can only be positive
boba <- sample(0:25, 100, replace = TRUE)
student_size <- sample(15000:50000, 100, replace = TRUE)
school_climate <- sample(c("freezing", "snowy", "cool", "warm", "hot", "humid"), 100, replace = TRUE)
student_interest <- sample(c("very low", "low", "moderate", "high", "very high"), 100, replace = TRUE)
boba_dataset <- cbind.data.frame(state_university, radius, boba, student_size, school_climate, student_interest)
library(tidyverse)
se <- function(column){
sd(column)/sqrt(length(column))
}
summary_boba_dataset <- boba_dataset %>% group_by(school_climate, student_interest) %>% summarise(mean = mean(boba), SD = sd(boba), SE = se(boba))
subset(boba_dataset, boba_dataset$school_climate=="cool" & boba_dataset$student_interest=="high")
ggplot(summary_boba_dataset, aes(school_climate, mean, fill = student_interest)) + geom_bar(stat = "identity", position = position_dodge()) + geom_errorbar(aes(ymin = mean - SE, ymax = mean + SE), position = position_dodge2(), width = .9)
ggplot(boba_dataset, aes(school_climate, boba, fill = student_interest)) + geom_boxplot() + facet_wrap(~student_interest)
library(ggeffects)
lm1 <- lm(boba~student_interest*school_climate, data = boba_dataset)
a <- ggpredict(lm1, terms = c("student_interest", "school_climate"))
plot(a)
ggplot(boba_dataset, aes(student_size, boba, color = student_interest)) + geom_point() + geom_smooth(method="lm") + facet_wrap(~student_interest)
lm(Value ~ Question * Country, data = violence)
lm(Value ~ Question * Country, data = violence)
violence_question_two <- violence %>%
group_by(Question, Country) %>%
summarize(mean = mean(Value, na.rm = TRUE), se = sd(Value, na.rm = TRUE) / sqrt(n()))
ggplot(violence_question_two, aes(Question, mean_value, color = Country, group = Country)) + geom_point(size = 3) + geom_smooth(method = "lm") +
labs(y = "Mean Value",
title = "Interaction: Question × Country")
ggplot(violence_question_two, aes(Question, mean, color = Country, group = Country)) + geom_point(size = 3) + geom_smooth(method = "lm") +
labs(y = "Mean Value",
title = "Interaction: Question × Country")
ggplot(violence_question_two, aes(Question, mean, color = Country, group = Country)) + geom_point(size = 3) + geom_smooth(method = "lm") + facet_wrap(~ Country)
ggplot(violence_question_two, aes(Question, mean, color = Country, group = Country)) + geom_point(size = 3) + geom_smooth(method = "lm") + facet_wrap(~ Country) + theme(axis.text.x = element_text(angle = 90)) +
labs(y = "Mean Value",
title = "Interaction: Question × Country")
summary(lm(Value ~ Question * Country, data = violence))
violence$Question <- relevel(as.factor(violence$Question), ref = "... if she burns the food")
summary(lm(Value ~ Question, data = violence))
violence_question_one <- violence %>%
group_by(Question) %>%
summarize(mean = mean(Value, na.rm = TRUE), se = sd(Value, na.rm = TRUE) / sqrt(n()))
ggplot(violence_question_one, aes(Question, mean)) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence")
ggplot(violence_question_one, aes(Question, Value)) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence")
ggplot(violence, aes(Question, Value)) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence")
ggplot(violence, aes(Question, Value)) + facet_wrap(~ Question) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence")
ggplot(violence, aes(Question, Value)) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence")
ggplot(violence, aes(Question, Value)) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence") + geom_jitter()
ggplot(violence_question_one, aes(Question, mean)) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence")
ggplot(violence_question_one, aes(Question, mean)) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence") + + geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2)
ggplot(violence_question_one, aes(Question, mean)) + geom_point(size = 3) + geom_smooth(method = "lm") + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence") + geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2)
ggplot(violence_question_one, aes(Question, mean)) + geom_bar(size = 3) + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence") + geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2)
ggplot(violence_question_one, aes(Question, mean)) + geom_bar() + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence") + geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2)
ggplot(violence_question_one, aes(Question, mean)) + geom_bar(stat = "identity", position = position_dodge()) + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence") + geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2)
summary(lmer(Value ~ Question * Survey.Year + (1 | Country), data = violence))
library(lme4)
summary(lmer(Value ~ Question * Survey.Year + (1 | Country), data = violence))
summary(lmer(Value ~ Question * Survey.Year * Marital status * Education * Residence * Age + (1 | Country), data = violence))
summary(lmer(Value ~ Question * Survey.Year * "Marital status" * Education * Residence * Age + (1 | Country), data = violence))
summary(lmer(Value ~ Question * Survey.Year * Marital status * Education * Residence * Age + (1 | Country), data = violence))
summary(lmer(Value ~ Question * Survey.Year * `Marital status` * Education * Residence * Age + (1 | Country), data = violence))
summary(lmer(Value ~ Question * Survey.Year * "Marital status" * Education * Residence * Age + (1 | Country), data = violence))
table(violence$Demographics.Question, violence$Value)
```
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "Question", "Survey.Year", "Value"), names_from = "Demographics.Question", values_from = c("Demographics.Response"))
View(violence_wider)
summary(lmer(Value ~ Question * Survey.Year * "Marital status" * Education * Residence * Age + (1 | Country), data = violence_wider))
lmer(Value ~ Question * Survey.Year * "Marital status" * Education * Residence * Age + (1 | Country), data = violence_wider)
lmer(Value ~ Question * Survey.Year * `Marital status` * Education * Residence * Age + (1 | Country), data = violence_wider)
violence_wider$`Marital status` <- violence_wider$Marital_status #changed Marital status to Marital_status
View(violence_wider)
violence <- read.csv("~/PSY 4802/Project-for-PSY-4802/20200306 Data International Women's Day Viz5 Launch.csv")
View(violence)
library(tidyverse)
library(ggplot2)
violence$Question <- relevel(as.factor(violence$Question), ref = "... if she burns the food")
summary(lm(Value ~ Question, data = violence))
violence_question_one <- violence %>%
group_by(Question) %>%
summarize(mean = mean(Value, na.rm = TRUE), se = sd(Value, na.rm = TRUE) / sqrt(n()))
ggplot(violence_question_one, aes(Question, mean)) + geom_bar(stat = "identity", position = position_dodge()) + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence") + geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2)
summary(lm(Value ~ Question * Country, data = violence))
violence_question_two <- violence %>%
group_by(Question, Country) %>%
summarize(mean = mean(Value, na.rm = TRUE), se = sd(Value, na.rm = TRUE) / sqrt(n()))
ggplot(violence_question_two, aes(Question, mean, color = Country, group = Country)) + geom_point(size = 3) + geom_smooth(method = "lm") + facet_wrap(~ Country) + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Interaction Effects of Type of Violence × Country on Justification of Violence")
#not sure if this type of graph makes sense here or if graph type from first question would be better here
library(lme4)
summary(lmer(Value ~ Question * Survey.Year + (1 | Country), data = violence))
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "Question", "Survey.Year", "Value"), names_from = "Demographics.Question", values_from = c("Demographics.Response")) #pivoeted dataset wider
violence_wider$Marital_status <- violence_wider$`Marital status` #changed Marital status to Marital_status
View(violence_wider)
lmer(Value ~ Question * Survey.Year * Marital_status * Education * Residence * Age + (1 | Country), data = violence_wider)
View(violence_wider)
View(violence)
View(violence_wider)
violence_wider$Marital_status=="Widowed or divorced or separated" <- violence_wider$`Marital status`=="Widowed, divorced, separated" #changed Marital status to Marital_status for easier coding and changed "Widowed, divorced, separated" to "Widowed or divorced or separated" because R was reading the Marital status varaible as a list due to the commas
violence_wider$Marital_status <- factor(violene_wider$Marital_status, levels = c("Widowed, divorced, separated", labels = c("Widowed or divorced or separated"))
lmer(Value ~ Question * Survey.Year * Marital_status * Education * Residence * Age + (1 | Country), data = violence_wider)
violence_wider$Marital_status <- factor(violene_wider$Marital_status, levels = c("Widowed, divorced, separated", labels = c("Widowed or divorced or separated"))
View(violence_wider)
View(violence_wider)
violence_wider$Marital_status <- factor(violene_wider$Marital_status, levels = c("Widowed, divorced, separated"), labels = c("Widowed or divorced or separated"))
violence_wider$Marital_status <- factor(violence_wider$Marital_status, levels = c("Widowed, divorced, separated"), labels = c("Widowed or divorced or separated"))
View(violence_wider)
rownames(violence$Marital status)
> rownames(violence$`Marital status`)
levels(as.factor(smh$sleepQuality))
levels(violence$`Marital status`)
levels(as.factor(violence$`Marital status`)
> levels(as.factor(violence$`Marital status`))
levels(as.factor(violence$`Marital status`))
levels(as.factor(violence$Employment))
levels(as.factor(violence$Survey.Year))
levels(as.factor(violence$`Marital status`))
violence_wider$Marital_status <- factor(violence_wider$Marital_status, levels = c("Married or living together", "Never married", "Widowed, divorced, separated"), labels = c("Married or living together", "Never married", "Widowed or divorced or separated"))
View(violence_wider)
violence_wider$Marital_status <- factor(violence_wider$Marital_status, levels = c("Married or living together", "Never married", "Widowed, divorced, separated", "NULL"), labels = c("Married or living together", "Never married", "Widowed or divorced or separated", "NULL"))
View(violence_wider)
colnames(violence_wider)
names(violence_wider)
violence_wider$Marital_status <- factor(violence_wider$`Marital status`) #changed Marital status to Marital_status factor for easier coding
violence_wider$Marital_status <- as.factor(violence_wider$`Marital status`) #changed Marital status to Marital_status factor for easier coding
violence_wider$Marital_status <- as.character(violence_wider$`Marital status`)
violence_wider$Marital_status <- factor(violence_wider$Marital_status, levels = c("Married or living together", "Never married", "Widowed, divorced, separated", "NULL"), labels = c("Married or living together", "Never married", "Widowed or divorced or separated", "NULL"))
View(violence_wider)
violence <- read.csv("~/PSY 4802/Project-for-PSY-4802/20200306 Data International Women's Day Viz5 Launch.csv")
View(violence)
library(tidyverse)
library(ggplot2)
violence$Question <- relevel(as.factor(violence$Question), ref = "... if she burns the food")
summary(lm(Value ~ Question, data = violence))
violence_question_one <- violence %>%
group_by(Question) %>%
summarize(mean = mean(Value, na.rm = TRUE), se = sd(Value, na.rm = TRUE) / sqrt(n()))
ggplot(violence_question_one, aes(Question, mean)) + geom_bar(stat = "identity", position = position_dodge()) + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Main Effects of Type of Violence on Justification of Violence") + geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2)
summary(lm(Value ~ Question * Country, data = violence))
violence_question_two <- violence %>%
group_by(Question, Country) %>%
summarize(mean = mean(Value, na.rm = TRUE), se = sd(Value, na.rm = TRUE) / sqrt(n()))
ggplot(violence_question_two, aes(Question, mean, color = Country, group = Country)) + geom_point(size = 3) + geom_smooth(method = "lm") + facet_wrap(~ Country) + theme(axis.text.x = element_text(angle = 90)) + labs(x = "Question Type", y = "Mean Justification of Violence Score Across Demographic Variables", title = "Interaction Effects of Type of Violence × Country on Justification of Violence")
#not sure if this type of graph makes sense here or if graph type from first question would be better here, will ask Dr. Woodward in next meeting on December 3
library(lme4)
summary(lmer(Value ~ Question * Survey.Year + (1 | Country), data = violence))
#not sure how linear mixed model effects should be visualized differently, will ask Dr. Woodward in next meeting on December 3
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "Question", "Survey.Year", "Value"), names_from = "Demographics.Question", values_from = c("Demographics.Response")) #pivoted dataset wider
violence_wider$Marital_status <- as.character(violence_wider$`Marital status`)
violence_wider$Marital_status <- factor(violence_wider$Marital_status)
lmer(Value ~ Question * Survey.Year * Marital_status * Education * Residence * Age + (1 | Country), data = violence_wider)
violence_wider <- pivot_wider(violence, id_cols = c("RecordID", "Country", "Gender", "Question", "Survey.Year", "Value"), names_from = "Demographics.Question", values_from = c("Demographics.Response")) #pivoted dataset wider
violence_wider$Marital_status <- as.character(violence_wider$`Marital status`)
violence_wider$Marital_status <- factor(violence_wider$Marital_status)
#changed Marital status to Marital_status for easier coding and from list to character to factor (couldn't go straight to factor for some reason)
violence_wider$Education <- as.character(violence_wider$Education)
violence_wider$Education <- factor(violence_wider$Education)
#changed from list to character to factor (couldn't go straight to factor for some reason)
violence_wider$Residence <- as.character(violence_wider$Residence)
violence_wider$Residence <- factor(violence_wider$Residence)
#changed from list to character to factor (couldn't go straight to factor for some reason)
violence_wider$Age <- as.character(violence_wider$Age)
violence_wider$Age <- factor(violence_wider$Age)
#changed from list to character to factor (couldn't go straight to factor for some reason)
lmer(Value ~ Question * Survey.Year * Marital_status * Education * Residence * Age + (1 | Country), data = violence_wider)
lmer(Value ~ Question * Survey.Year * Marital_status * Education * Residence * Age + (1 | Country), data = violence_wider)
